<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-project-basics/high-level-components" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">High-level Components | Kube Project</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kube-project.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kube-project.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kube-project.github.io/docs/project-basics/high-level-components"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="High-level Components | Kube Project"><meta data-rh="true" name="description" content="Let&#x27;s take a look at what components this project consists of."><meta data-rh="true" property="og:description" content="Let&#x27;s take a look at what components this project consists of."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kube-project.github.io/docs/project-basics/high-level-components"><link data-rh="true" rel="alternate" href="https://kube-project.github.io/docs/project-basics/high-level-components" hreflang="en"><link data-rh="true" rel="alternate" href="https://kube-project.github.io/docs/project-basics/high-level-components" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kube Project RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kube Project Atom Feed"><link rel="stylesheet" href="/assets/css/styles.a0e99879.css">
<script src="/assets/js/runtime~main.afb3b7b1.js" defer="defer"></script>
<script src="/assets/js/main.797f496d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Kube Project Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Kube Project Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kube Project</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/start-here">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kube-project/kube-project.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/start-here">Kube Project</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/kubernetes---basics">Kubernetes - Basics</a><button aria-label="Expand sidebar category &#x27;Kubernetes - Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/project---basics">Project - Basics</a><button aria-label="Collapse sidebar category &#x27;Project - Basics&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/project-basics/high-level-components">High-level Components</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/extending-the-project">Extending the Project</a><button aria-label="Expand sidebar category &#x27;Extending the Project&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/project---basics"><span itemprop="name">Project - Basics</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">High-level Components</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>High-level Components</h1>
<p>Let&#x27;s take a look at what components this project consists of.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="database">Database<a href="#database" class="hash-link" aria-label="Direct link to Database" title="Direct link to Database">​</a></h2>
<p>In all distributed applications there has to be a sync point between the processed data. In this application that point
is the database. All of the components use transactions to stay up-to-date with all changes and to prevent data races.</p>
<p>The database could be sharded and distributed, but we won&#x27;t cover that in this guide.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="nsq">NSQ<a href="#nsq" class="hash-link" aria-label="Direct link to NSQ" title="Direct link to NSQ">​</a></h2>
<p><a href="https://github.com/nsqio/go-nsq" target="_blank" rel="noopener noreferrer">NSQ</a> was choosen as a message broker between two of the components to decouple the
workload handling. Basically, one of the components deals with processing incoming images and then handles over image
ids through the queue to the next component whihc will deal with the image recognition.</p>
<p>The queue is pretty sturdy, handles multiple processors and produces, can be distributed and handles re-sending unprocessed
entries.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="receiver">Receiver<a href="#receiver" class="hash-link" aria-label="Direct link to Receiver" title="Direct link to Receiver">​</a></h2>
<p>The <a href="https://github.com/kube-project/receiver-service" target="_blank" rel="noopener noreferrer">receiver service</a> is the entry point into the whole process. It&#x27;s an API which receives a request in the following format:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -d &#x27;{&quot;path&quot;:&quot;/unknown_images/unknown0001.jpg&quot;}&#x27; http://127.0.0.1:8000/image/post</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Once that request is received the following process is kicked off:</p>
<ul>
<li>write the path in to the database and create an entry in <code>Pending</code> state</li>
<li>if the write is successful send the image ID to NSQ</li>
</ul>
<p>It can process multiple images at once as well.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="image-processor">Image Processor<a href="#image-processor" class="hash-link" aria-label="Direct link to Image Processor" title="Direct link to Image Processor">​</a></h2>
<p>Here is where the excitement begins. When Image Processor first runs it creates two Go routines. These are...</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="consume">Consume<a href="#consume" class="hash-link" aria-label="Direct link to Consume" title="Direct link to Consume">​</a></h3>
<p>This is an NSQ consumer. It has three integral jobs. Firstly, it listens for messages on the queue. Secondly, when there
is a message, it appends the received ID to a thread safe slice of IDs that the second routine processes. And lastly,
it signals the second routine that there is work to be do with a mediator.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="processimages">ProcessImages<a href="#processimages" class="hash-link" aria-label="Direct link to ProcessImages" title="Direct link to ProcessImages">​</a></h3>
<p>This routine processes an ID that it gets from the consumer. The processing of a single ID can be seen in the following
linear steps:</p>
<ul>
<li>Establish a gRPC connection to the Face Recognition service (explained under Face Recognition)</li>
<li>Retrieve the image record from the database</li>
<li>Setup two functions for the <a href="#circuit-breaker">Circuit Breaker</a>
<ul>
<li>Function 1: The main function which runs  the RPC method call</li>
<li>Function 2: A health check for the Ping of the circuit breaker</li>
</ul>
</li>
<li>Call Function 1 which sends the path of the image to the face recognition service. This path should be accessible by
the face recognition service. Preferably something shared like an NFS</li>
<li>If this call fails, update the image record as FAILED PROCESSING</li>
<li>If it succeeds, an image name should come back which corresponds to a person in the db. It runs a joined SQL query
which gets the corresponding person&#x27;s ID</li>
<li>Update the Image record in the database with PROCESSED status and the ID of the person that image was identified as</li>
</ul>
<p>This service can be replicated. In other words, more than one can run at the same time.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>This whole process could be made even more resilient by batch processing several IDs received from the consumer service.
Right now it has a 1 length buffered channel only.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="circuit-breaker">Circuit Breaker<a href="#circuit-breaker" class="hash-link" aria-label="Direct link to Circuit Breaker" title="Direct link to Circuit Breaker">​</a></h3>
<p>A system in which replicating resources requires little to no effort, there still can be cases where, for example, the
network goes down, or there are communication problems of any kind between two services. I like to implement a little
circuit breaker around the gRPC calls for fun.</p>
<p>The code is located <a href="https://github.com/kube-project/image-processor-service/blob/c23655eaec2efce139be7f29603c8a767999a29f/pkg/providers/circuitbreaker/circuitbreaker.go" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>This is how it works:</p>
<p><img decoding="async" loading="lazy" alt="kube circuit" src="/assets/images/kube_circuit1-9d943d2e9e9724889cbfc829159e2ba5.png" width="800" height="576" class="img_ev3q"></p>
<p>Once there are 5 unsuccessful calls to the service, the circuit breaker activates, not allowing any more calls to go
through. After a configured amount of time, it will send a Ping call to the service to see if it&#x27;s back up. If that
still errors out, it will increase the timeout. If not, it opens the circuit, allowing traffic to proceed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="face-recognition-service">Face Recognition Service<a href="#face-recognition-service" class="hash-link" aria-label="Direct link to Face Recognition Service" title="Direct link to Face Recognition Service">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="face-recognition">Face Recognition<a href="#face-recognition" class="hash-link" aria-label="Direct link to Face Recognition" title="Direct link to Face Recognition">​</a></h2>
<p>Here is where the identification happens. I decided to make this a gRPC based service for the  sole purpose of its
flexibility. I started writing it in Go but decided that a Python implementation would be much sorter. In fact,
excluding the gRPC code, the recognition part is approximately 7 lines of Python code. I&#x27;m using this fantastic library
which contains all the C bindings to dlib. <a href="https://github.com/ageitgey/face_recognition" target="_blank" rel="noopener noreferrer">Face Recognition</a>. Having an
API contract here means that I can change the implementation anytime as long as it adheres to the contract.</p>
<p>Please note that there exist a great Go library OpenCV. I was about to use it but they had yet to write the C bindings
for that part of OpenCV. It&#x27;s called <a href="https://gocv.io/" target="_blank" rel="noopener noreferrer">GoCV</a>. Check them out! They have some pretty amazing things,
like real-time camera feed processing that only needs a couple of lines of code.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>There is also now <a href="https://github.com/Kagami/go-face" target="_blank" rel="noopener noreferrer">Kagami/go-face</a> which comes pretty close, but has been discontinued.</p><p>There is also <a href="https://github.com/esimov/pigo" target="_blank" rel="noopener noreferrer">pigo</a> but that is for face <em>detection</em>.</p></div></div>
<p>The python library is simple in nature. Have a set of images of people you know. I have a folder with a couple of images
named, <code>hannibal_1.jpg, hannibal_2.jpg, gergely_1.jpg, john_doe.jpg</code>. In the database I have two tables named,
<code>person, person_images</code>. They look like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| id | name     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  1 | Gergely  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  2 | John Doe |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  3 | Hannibal |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----+----------------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| id | image_name     | person_id |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----+----------------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  1 | hannibal_1.jpg |         3 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  2 | hannibal_2.jpg |         3 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----+----------------+-----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The face recognition library returns the name of the image from the known people which matches the person on the
unknown image. After that, a simple joined query -like this- will return the person in question.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> person</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> person</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">id </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> person </span><span class="token keyword" style="color:#00009f">inner</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">join</span><span class="token plain"> person_images </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pi </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> person</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">person_id </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> image_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;hannibal_2.jpg&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The gRPC call returns the ID of the person which is then used to update the image&#x27;s <code>person</code> column.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="frontend">Frontend<a href="#frontend" class="hash-link" aria-label="Direct link to Frontend" title="Direct link to Frontend">​</a></h2>
<p>This is only a simple table view with Go&#x27;s own html/template used to render a list of images.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/project---basics"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Project - Basics</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/extending-the-project"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Extending the Project</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#database" class="table-of-contents__link toc-highlight">Database</a></li><li><a href="#nsq" class="table-of-contents__link toc-highlight">NSQ</a></li><li><a href="#receiver" class="table-of-contents__link toc-highlight">Receiver</a></li><li><a href="#image-processor" class="table-of-contents__link toc-highlight">Image Processor</a><ul><li><a href="#consume" class="table-of-contents__link toc-highlight">Consume</a></li><li><a href="#processimages" class="table-of-contents__link toc-highlight">ProcessImages</a></li><li><a href="#circuit-breaker" class="table-of-contents__link toc-highlight">Circuit Breaker</a></li></ul></li><li><a href="#face-recognition-service" class="table-of-contents__link toc-highlight">Face Recognition Service</a></li><li><a href="#face-recognition" class="table-of-contents__link toc-highlight">Face Recognition</a></li><li><a href="#frontend" class="table-of-contents__link toc-highlight">Frontend</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/start-here">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kube-project/kube-project.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Kube Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>